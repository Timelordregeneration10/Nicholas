<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>star ring upload</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        background-color: black;
      }

      .frame {
        position: relative;
        width: 100vw;
        height: 100vh;
        /* background-color: #000; */
        /* overflow: hidden; */
        perspective: 300vmax;
        transform-style: preserve-3d;
      }

      .star-ring-fragment {
        position: absolute;
        top: calc(50vh - 20px);
        left: calc(50vw - 20px);
        width: 40px;
        height: 40px;
        background-color: #ffffff;
        box-shadow: 0px 0px 16px #91bef0;
        transform-style: preserve-3d;
      }

      .origin-stable {
        position: absolute;
        top: calc(50vh - 180px);
        left: calc(50vw - 180px);
        width: 360px;
        height: 360px;
        display: flex;
        justify-content: center;
        align-items: center;
        transform-style: preserve-3d;
        background-color: #ffffff;
        border-radius: 50%;
        box-shadow: 0px 0px 40px #91bef0;
        cursor: pointer;
        color: rgba(255, 195, 255, 0.443);
        font-size: 4.5vmax;
        font-weight: bold;
        font-family: fantasy;
      }
    </style>
  </head>
  <body>
    <div class="frame">
      <div class="origin-stable" onclick="upload()">uplaod</div>
    </div>
  </body>
  <script>
    const frame = document.getElementsByClassName("frame")[0];
    const edge = 36;
    const durationSec = 120;

    function addKeyframes() {
      const styleDom = document.createElement("style");
      styleDom.type = "text/css";
      let innerHTMLs = ``;
      for (let i = 0; i < edge; i++) {
        innerHTMLs += `
          @keyframes star-ring-fragment-rotate-${i} {
            0% {
              transform: rotateY(10deg) rotateX(${
                (360 / edge) * i
              }deg) translateZ(300px);
            }
            100% {
              transform: rotateY(10deg) rotateX(${
                (360 / edge) * i + 360
              }deg) translateZ(300px);
            }
          }
        `;
      }
      for (let i = 0; i < edge; i++) {
        innerHTMLs += `
          @keyframes star-ring-fragment-rotate2-${i} {
            0% {
              transform: rotateX(10deg) rotateY(${
                (360 / edge) * i
              }deg) translateZ(300px);
            }
            100% {
              transform: rotateX(10deg) rotateY(${
                (360 / edge) * i + 360
              }deg) translateZ(300px);
            }
          }
        `;
      }
      styleDom.innerHTML = innerHTMLs;
      document.head.appendChild(styleDom);
    }
    addKeyframes();

    function addStarRingFragment() {
      for (let i = 0; i < edge; i++) {
        const fragment = document.createElement("div");
        fragment.className = "star-ring-fragment";
        fragment.style.transform = `rotateY(10deg) rotateX(${
          (360 / edge) * i
        }deg) translateZ(300px)`;
        fragment.style.animation = `star-ring-fragment-rotate-${i} ${durationSec}s linear infinite`;
        frame.appendChild(fragment);
      }
      for (let i = 0; i < edge; i++) {
        const fragment = document.createElement("div");
        fragment.className = "star-ring-fragment";
        fragment.style.transform = `rotateX(10deg) rotateY(${
          (360 / edge) * i
        }deg) translateZ(300px)`;
        fragment.style.animation = `star-ring-fragment-rotate2-${i} ${durationSec}s linear infinite`;
        frame.appendChild(fragment);
      }
    }
    addStarRingFragment();

    function upload() {
      const input = document.createElement("input");
      input.type = "file";
      input.accept = "image/*";
      input.onchange = (event) => {
        const file = event.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = (e) => {
            const imgsrc = e.target.result;
            const fragments =
              document.getElementsByClassName("star-ring-fragment");
            for (let i = 0; i < fragments.length; i++) {
              fragments[i].style.backgroundImage = `url(${imgsrc})`;
              fragments[i].style.backgroundSize = "cover";
            }
          };
          reader.readAsDataURL(file);
        }
      };
      input.click();
    }
  </script>
</html>
